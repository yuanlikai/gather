webpackJsonp([7],{VgOG:function(t,e){},f70j:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("lDlD"),r={data:function(){var t=this;return{model:!1,dataSite:[],ssq:[],formValidate:{consignee:"",phone:"",ssq:[],address:""},ruleValidate:{consignee:[{required:!0,message:"请填写",trigger:"blur"}],ssq:[{required:!0,type:"array",min:3,message:"请选择",trigger:"change"}],phone:[{validator:function(e,s,a){/^1[3456789]\d{9}$/.test(t.formValidate.phone)?a():a(new Error("请填写正确手机号"))},required:!0,trigger:"blur"}],address:[{required:!0,message:"请填写",trigger:"blur"}]}}},methods:{getSite:function(t){this.formValidate.consignee=t.consignee,this.formValidate.phone=t.phone,this.formValidate.address=t.address},dzjhs:function(t,e){this.ssq=e},handleSubmit:function(t){var e=this,s=this;this.$refs[t].validate(function(t){t?s.Axios.post("/Manage/Order/updateOrderAddress",s.Qs.stringify({id:s.$route.query.idstr,consignee:s.formValidate.consignee,phone:s.formValidate.phone,province:s.ssq[0].label,city:s.ssq[1].label,area:s.ssq[2].label,address:s.formValidate.address})).then(function(t){0===t.data.error?(s.model=!1,s.$emit("getOrder"),e.$Message.success("成功!")):e.$Message.warning(t.data.errorMsg)}):e.$Message.error("请填写必填项!")})},handleReset:function(t){this.$refs[t].resetFields()},getSsq:function(){var t=this;t.Axios.get("/Manage/Region/region").then(function(e){t.dataSite=e.data.RegionList})}},mounted:function(){this.getSsq()}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{width:"360"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[s("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),s("span",[t._v("修改配送地址")])],1),t._v(" "),s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[s("FormItem",{attrs:{label:"收件人",prop:"consignee"}},[s("Input",{attrs:{placeholder:"请填写"},model:{value:t.formValidate.consignee,callback:function(e){t.$set(t.formValidate,"consignee",e)},expression:"formValidate.consignee"}})],1),t._v(" "),s("FormItem",{attrs:{label:"手机号",prop:"phone"}},[s("Input",{attrs:{placeholder:"请填写"},model:{value:t.formValidate.phone,callback:function(e){t.$set(t.formValidate,"phone",e)},expression:"formValidate.phone"}})],1),t._v(" "),s("FormItem",{attrs:{label:"选择地区",prop:"ssq"}},[s("Cascader",{attrs:{data:t.dataSite},on:{"on-change":t.dzjhs},model:{value:t.formValidate.ssq,callback:function(e){t.$set(t.formValidate,"ssq",e)},expression:"formValidate.ssq"}})],1),t._v(" "),s("FormItem",{attrs:{label:"详细地址",prop:"address"}},[s("Input",{attrs:{type:"textarea",placeholder:"请填写"},model:{value:t.formValidate.address,callback:function(e){t.$set(t.formValidate,"address",e)},expression:"formValidate.address"}})],1)],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("确认")])],1)],1)},staticRenderFns:[]},o=s("VU/8")(r,i,!1,null,null,null).exports,n={components:{express:a.a,alterSite:o},data:function(){return{model:!1,formValidate:{abnormalstr:""},ruleValidate:{abnormalstr:[{required:!0,message:"请填写异常备注",trigger:"blur"}]},loading:!0,columns1:[{title:"操作者",tooltip:!0,minWidth:88,align:"center"},{title:"操作时间",tooltip:!0,minWidth:88,align:"center"},{title:"操作状态",tooltip:!0,minWidth:88,align:"center"},{title:"操作后状态",tooltip:!0,minWidth:88,align:"center"},{title:"备注",tooltip:!0,minWidth:88,align:"center"}],columns:[{title:"商品名称",tooltip:!0,key:"ProductName",minWidth:88,align:"center"},{title:"货号",tooltip:!0,key:"StockNo",minWidth:88,align:"center"},{title:"数量",tooltip:!0,key:"Num",minWidth:88,align:"center"},{title:"单价",tooltip:!0,key:"Price",minWidth:88,align:"center"},{title:"小计",tooltip:!0,key:"SumPrice",minWidth:88,align:"center"}],data:[],OperBtn:[]}},methods:{afterSsa:function(){this.$refs.alterSite.model=!0,this.$refs.alterSite.getSite({consignee:this.data.Consignee,phone:this.data.Phone,address:this.data.Address})},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.abnormal()})},abnormal:function(){var t=this;t.Axios.post("/Manage/Order/operTransAbnormal",t.Qs.stringify({orderid:t.$route.query.idstr,abnormalstr:t.formValidate.abnormalstr})).then(function(e){0===e.data.error?(t.model=!1,t.$Message.success("转为异常成功")):t.$Message.warning(e.data.errorMsg)})},amend:function(){this.$refs.express.model=!0,this.$refs.express.formDynamic.idstr=this.$route.query.idstr;for(var t=0;t<this.data.Express.split("，").length;t++)this.$refs.express.formDynamic.items[t]={Express:this.data.Express.split("，")[t],ExpressNo:this.data.ExpressNo.split("，")[t]}},getDetails:function(){var t=this;t.Axios.get("/Manage/Order/detail",{params:{idstr:t.$route.query.idstr}}).then(function(e){0===e.data.error?(t.OperBtn=e.data.data,t.data=e.data):t.$Message.error(e.data.errorMsg),t.loading=!1})}},mounted:function(){this.getDetails()}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("Card",{staticStyle:{border:"none",margin:"16px 0"}},[s("div",{staticClass:"ivu-page-header-title"},[t._v("当前订单状态：\n      "),"true"==t.$route.query.abnormal?s("span",{staticStyle:{color:"red"}},[t._v("异常")]):s("span",{staticStyle:{color:"red"}},[t._v(t._s(t.data.StateStr))])]),t._v(" "),s("ButtonGroup",{staticStyle:{float:"right"}},["true"!=t.$route.query.abnormal?s("Button",{attrs:{type:"dashed"},on:{click:function(e){t.model=!0}}},[t._v("转为异常订单")]):s("Button",{attrs:{type:"dashed"}},[t._v("取消异常订单")])],1)],1),t._v(" "),s("Content",{style:{position:"relative",margin:"0 20px 20px 20px",background:"#fff",padding:"16px",height:"auto"}},[t.loading?s("Spin",{attrs:{fix:""}}):t._e(),t._v(" "),s("Row",{attrs:{gutter:30}},[s("Col",{attrs:{span:"24"}},[s("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("基本信息")])]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        OMS单号："+t._s(t.data.ErpOrderNumber)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        平台单号："+t._s(t.data.OrderNumber)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        平台："+t._s(t.data.PlatformName)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        用户名："+t._s(t.data.UserName)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        下单时间："+t._s(t.data.AddTime)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        支付方式："+t._s(t.data.PayTypeStr)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        供应商："+t._s(t.data.Supplier)+"\n      ")])],1),t._v(" "),s("Divider"),t._v(" "),s("Row",{attrs:{gutter:30}},[s("Col",{attrs:{span:"24"}},[s("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("收货人及物流信息")])]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        快递公司："+t._s(t.data.Express)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        收货人："+t._s(t.data.Consignee)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        手机号："+t._s(t.data.Phone)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        物流单号："+t._s(t.data.ExpressNo)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{md:24,lg:16}},[t._v("\n        地址："+t._s(t.data.Address)+"\n      ")]),t._v(" "),s("Button",{staticStyle:{"margin-left":"16px"},attrs:{type:"primary"},on:{click:t.amend}},[t._v(t._s(t.data.ExpressNo?"修改":"填写")+"物流信息\n      ")]),t._v(" "),s("Button",{staticStyle:{"margin-left":"16px"},on:{click:t.afterSsa}},[t._v("修改配送信息\n      ")])],1),t._v(" "),s("Divider"),t._v(" "),s("Row",{attrs:{gutter:30}},[s("Col",{attrs:{span:"24"}},[s("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("商品信息")])]),t._v(" "),s("Col",{attrs:{span:"24"}},[s("Table",{attrs:{"show-header":!0,columns:t.columns,data:t.OperBtn}})],1)],1),t._v(" "),s("Row",{staticStyle:{"font-size":"14px"},attrs:{gutter:30}},[s("Col",{staticStyle:{"margin-top":"16px"},attrs:{xs:{span:9,offset:1},lg:{span:11,offset:1}}},[t._v("\n        运费："+t._s(t.data.Freight)+"\n      ")]),t._v(" "),s("Col",{staticStyle:{"margin-top":"16px","text-align":"right"},attrs:{xs:13,lg:{span:11,pull:0}}},[t._v("\n        合计："),s("span",{staticStyle:{color:"red","font-weight":"700"}},[t._v(t._s(t.data.Total))]),t._v(" (不含运费)\n      ")])],1),t._v(" "),s("Divider"),t._v(" "),s("Row",{attrs:{gutter:30}},[s("Col",{attrs:{span:"24"}},[s("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("备注信息")])]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{span:"24"}},[t._v("\n        用户留言："+t._s(t.data.Remarks)+"\n      ")]),t._v(" "),s("Col",{staticClass:"colClass",attrs:{span:"24"}},[t._v("\n        客服备注："+t._s(t.data.RemarksHt)+"\n      ")])],1),t._v(" "),s("Divider")],1),t._v(" "),s("express",{ref:"express",on:{getOrder:t.getDetails}}),t._v(" "),s("Modal",{attrs:{width:"360"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[s("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),s("span",[t._v("确定转为异常？")])],1),t._v(" "),s("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":60}},[s("FormItem",{attrs:{label:"备注",prop:"abnormalstr"}},[s("Input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:t.formValidate.abnormalstr,callback:function(e){t.$set(t.formValidate,"abnormalstr",e)},expression:"formValidate.abnormalstr"}})],1)],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("确定")])],1)],1),t._v(" "),s("alterSite",{ref:"alterSite",attrs:{site:{consignee:t.data.Consignee,phone:t.data.Phone,address:t.data.address}},on:{getOrder:t.getDetails}})],1)},staticRenderFns:[]};var d=s("VU/8")(n,l,!1,function(t){s("VgOG")},"data-v-0a2f6906",null);e.default=d.exports},lDlD:function(t,e,s){"use strict";var a={data:function(){return{model:!1,formDynamic:{items:[{Express:"",ExpressNo:""}],idstr:"",Express:[],ExpressNo:[],Description:""},ruleValidate:{Description:[{required:!0,message:"The name cannot be empty",trigger:"blur"}]},cityList3:[]}},methods:{getRole:function(){var t=this;t.Axios.get("/Manage/Order/getExpressList").then(function(e){t.cityList3=e.data.data})},validatePass:function(t,e,s){var a=this.formDynamic.items[t.index];a.Express&&a.ExpressNo?s():s(new Error("物流信息("+(t.index+1)+")不能为空"))},handleSubmit:function(t){var e=this,s=this;for(var a in this.formDynamic.Express=[],this.formDynamic.ExpressNo=[],s.formDynamic.items)this.formDynamic.Express.push(s.formDynamic.items[a].Express),this.formDynamic.ExpressNo.push(s.formDynamic.items[a].ExpressNo);this.$refs[t].validate(function(t){t?s.Axios.post("/Manage/Order/updateOrder",s.Qs.stringify({idstr:s.formDynamic.idstr,statusid:2,Express:s.formDynamic.Express.join("，"),ExpressNo:s.formDynamic.ExpressNo.join("，"),Description:s.formDynamic.Description})).then(function(t){0===t.data.error?(s.$Message.success("发货成功"),s.$emit("getOrder"),s.$emit("statusNum"),s.model=!1):s.$Message.error(t.data.errorMsg)}):e.$Message.error("请填写物流信息！")})},handleAdd:function(){this.formDynamic.items.push({Express:"",ExpressNo:""})},handleRemove:function(t){this.formDynamic.items.length>1?this.formDynamic.items.splice(t,1):this.$Message.warning("至少填写一个物流信息！")}},mounted:function(){this.getRole()}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Modal",{attrs:{width:"360"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[s("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[s("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),s("span",[t._v("请填写发货信息")])],1),t._v(" "),s("Form",{ref:"formDynamic",staticStyle:{width:"300px"},attrs:{model:t.formDynamic,"label-width":84}},[t._l(t.formDynamic.items,function(e,a){return s("FormItem",{key:a,attrs:{label:"快递信息("+(a+1)+")",prop:"items."+a+".Express",rules:{validator:t.validatePass,required:!0,index:a,trigger:"change"}}},[s("Row",[s("Col",{attrs:{span:"18"}},[s("Select",{attrs:{placeholder:"请输入快递公司"},model:{value:e.Express,callback:function(s){t.$set(e,"Express",s)},expression:"item.Express"}},t._l(t.cityList3,function(e,a){return s("Option",{key:a,attrs:{value:e.Name}},[t._v(t._s(e.Name))])})),t._v(" "),s("Input",{attrs:{maxlength:20,type:"text",placeholder:"请输入物流单号"},model:{value:e.ExpressNo,callback:function(s){t.$set(e,"ExpressNo",s)},expression:"item.ExpressNo"}})],1),t._v(" "),s("Col",{attrs:{span:"4",offset:"1"}},[s("Button",{attrs:{size:"small"},on:{click:function(e){t.handleRemove(a)}}},[t._v("删除")])],1)],1)],1)}),t._v(" "),s("FormItem",[s("Row",[s("Col",{attrs:{span:"12"}},[s("Button",{attrs:{type:"dashed",long:"",icon:"md-add"},on:{click:t.handleAdd}},[t._v("添加快递")])],1)],1)],1),t._v(" "),s("FormItem",{attrs:{label:"备注信息",prop:"Description"}},[s("Input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.formDynamic.Description,callback:function(e){t.$set(t.formDynamic,"Description",e)},expression:"formDynamic.Description"}})],1)],2),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formDynamic")}}},[t._v(t._s(t.$route.query.idstr?"修改":"发货"))])],1)],1)},staticRenderFns:[]},i=s("VU/8")(a,r,!1,null,null,null);e.a=i.exports}});
//# sourceMappingURL=7.c4a8569a92d8f43ec053.js.map