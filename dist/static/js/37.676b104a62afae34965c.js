webpackJsonp([37],{CMEB:function(e,t){},ila4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={data:function(){var e=this;return{columns:[{title:"账号",tooltip:!0,key:"username"},{title:"姓名",tooltip:!0,key:"name"},{title:"角色",tooltip:!0,key:"roleNames"},{title:"操作",tooltip:!0,align:"center",width:"150",render:function(t,a){return t("div",[t("a",{on:{click:function(){e.amend(a.row.id,a.row.userInfoType,a.row.username,a.row.name,a.row.roleIds,a.row.status,a.row.allField)}}},"修改"),t("Divider",{props:{type:"vertical"}}),t("Poptip",{props:{confirm:!0,transfer:!0,placement:"left",title:"确定删除该用户？"},on:{"on-ok":function(){e.delHandle(a.row.id)}}},[t("a","删除")]),t("Divider",{props:{type:"vertical"}}),t("Poptip",{props:{confirm:!0,transfer:!0,placement:"left",title:"确定重置该用户？"},on:{"on-ok":function(){e.resetPass(a.row.id)}}},[t("a","重置")])])}}],like:"",id:"",handleId:"",total:0,start:0,cityList:[],loading:!0,statuss:!1,roleId:-1,status:-1,value13:"",value14:"",userInfoType:"",addAccount:!1,modal_loading:!1,roleName:"全部",roleList:[{id:-1,roleName:"全部"}],formValidate:{id:-1,roleIds:[],username:"",password:"",affirmPassword:"",name:"",supplierId:"",allField:!0},supplierList:"",ruleValidate:{username:[{validator:function(t,a,r){var s=e;a.length<1?r(new Error("请填写用户名")):s.Axios.post("/CheckUserName.ashx",{id:Number(s.formValidate.id),username:s.formValidate.username}).then(function(e){0===e.data.error?r():r(new Error(e.data.errorMsg))})},required:!0,trigger:"blur"}],password:[{required:!0,message:"请输入",trigger:"blur"}],affirmPassword:[{validator:function(t,a,r){a.length<1?r(new Error("请输入确认密码")):e.formValidate.password!==a?r(new Error("两次密码输入不一致")):r()},required:!0,trigger:"blur"}],roleIds:[{validator:function(e,t,a){t.length<1?a(new Error("请选择角色")):a()},required:!0,trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"blur"}],supplierId:[{required:!0,message:"请输入",trigger:"change"}]},data:[]}},methods:{resetPass:function(e){var t=this;t.Axios.post("/ResetPassword.ashx",{id:Number(e)}).then(function(e){0===e.data.error?t.$Message.success("成功"):t.$Message.warning(e.data.message)})},getSupplier:function(){var e=this;e.Axios.get("/GetSupList.ashx").then(function(t){0===t.data.error?e.supplierList=t.data.data:e.$Message.error(t.data.errorMsg)})},delHandle:function(e){var t=this;t.Axios.post("/DelAdminUser.ashx",{id:Number(e)}).then(function(e){0===e.data.error?(t.getUser(),t.$Message.success("删除成功")):t.$Message.error(e.data.errorMsg)})},amend:function(e,t,a,r,s,o,i){this.formValidate.id=e,this.addAccount=!0,this.userInfoType=t,this.formValidate.username=a,this.formValidate.name=r,this.formValidate.roleIds=s,this.formValidate.allField=i,this.statuss="0"===o},getRole:function(){var e=this;e.Axios.get("/GetSelectRole.ashx",{excludeSuper:!0,supplierExclusive:!0}).then(function(t){e.roleList=e.roleList.concat(t.data.data)})},cityRole:function(){var e=this;e.Axios.post("/GetSelectRole2.ashx",{excludeSuper:!0,supplierExclusive:!1}).then(function(t){e.cityList=t.data.data})},paging:function(e){this.start=e-1,this.getUser()},addUser:function(){this.id="",this.userInfoType="",this.handleReset("formValidate"),this.statuss=!1,this.addAccount=!0},Handle:function(e){this.handleId===e?this.handleId="":this.handleId=e},getUser:function(){var e=this;e.loading=!0,e.Axios.post("/GetSupAdminList.ashx",{page:e.start,pagesize:10,usernameLike:e.value13,supplierNameLike:e.value14,status:e.status,roleId:Number(e.roleId),userInfoType:""}).then(function(t){e.data=t.data.data,0===t.data.error||e.$Message.error(t.data.errorMsg),e.loading=!1,e.total=Number(t.data.total)})},handleSubmit:function(e){var t=this;t.$refs[e].validate(function(e){if(e)return t.modal_loading=!0,void t.Axios.post("/EditSupAdmin.ashx",{id:Number(t.formValidate.id),username:t.formValidate.username,password:t.formValidate.affirmPassword,name:t.formValidate.name,roleId:t.formValidate.roleIds.join(","),supplierId:Number(t.formValidate.supplierId),allField:t.formValidate.allField,sex:"MALE"}).then(function(e){0===e.data.error?(t.addAccount=!1,t.getUser(),t.$Message.success("success")):t.$Message.error(e.data.message),t.modal_loading=!1});t.$Message.error("有必填项未填写!")})},handleReset:function(e){this.$refs[e].resetFields()},abc:function(e){console.log(e.target.parentElement)}},mounted:function(){this.getUser(),this.cityRole(),this.getRole(),this.getSupplier()}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("Card",{staticStyle:{border:"none",margin:"16px 0"}},[a("div",{staticClass:"ivu-page-header-title",on:{click:e.abc}},[e._v("发货仓用户")])]),e._v(" "),a("Card",{style:{margin:"0 20px 20px 20px",background:"#fff",height:"auto"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n        基础列表\n      ")]),e._v(" "),a("p",{attrs:{slot:"extra"},slot:"extra"},[a("Icon",{attrs:{type:"ios-loop-strong"}}),e._v(" "),a("span",{staticClass:"users",staticStyle:{margin:"3px 4px 0 0"}},[e._v("角色:")]),e._v(" "),a("Select",{staticClass:"users",staticStyle:{width:"100px","margin-right":"16px"},on:{"on-change":function(t){e.start=0,e.getUser()}},model:{value:e.roleId,callback:function(t){e.roleId=t},expression:"roleId"}},e._l(e.roleList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.roleName))])})),e._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"用户名搜索"},on:{"on-enter":function(t){e.start=0,e.getUser()}},model:{value:e.value13,callback:function(t){e.value13=t},expression:"value13"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:function(t){e.start=0,e.getUser()}},slot:"suffix"})],1),e._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"供应商搜索"},on:{"on-enter":function(t){e.start=0,e.getUser()}},model:{value:e.value14,callback:function(t){e.value14=t},expression:"value14"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:function(t){e.start=0,e.getUser()}},slot:"suffix"})],1)],1),e._v(" "),a("Button",{staticStyle:{width:"100%","margin-bottom":"16px"},attrs:{type:"dashed"},on:{click:function(t){e.addUser()}}},[e._v("添加")]),e._v(" "),a("Table",{attrs:{"show-header":!0,columns:e.columns,data:e.data}}),e._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center","margin-top":"15px"}},[a("Page",{attrs:{total:e.total,"page-size":5,"show-elevator":"","show-total":""},on:{"on-change":e.paging}})],1)],1),e._v(" "),a("Modal",{attrs:{width:"300"},model:{value:e.addAccount,callback:function(t){e.addAccount=t},expression:"addAccount"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),a("span",[e._v(e._s(-1===e.formValidate.id?"添加":"修改")+"用户")])],1),e._v(" "),a("div",[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":70}},["SUPPLIER"!==e.userInfoType?a("FormItem",{attrs:{label:"用户账号",prop:"username"}},[a("Input",{attrs:{disabled:-1!==e.formValidate.id,maxlength:36,placeholder:"请输入账号"},model:{value:e.formValidate.username,callback:function(t){e.$set(e.formValidate,"username",t)},expression:"formValidate.username"}})],1):e._e(),e._v(" "),-1===e.formValidate.id?a("FormItem",{attrs:{label:"用户密码",prop:"password"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请输入密码"},model:{value:e.formValidate.password,callback:function(t){e.$set(e.formValidate,"password",t)},expression:"formValidate.password"}})],1):e._e(),e._v(" "),-1===e.formValidate.id?a("FormItem",{attrs:{label:"确认密码",prop:"affirmPassword"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请确认密码"},model:{value:e.formValidate.affirmPassword,callback:function(t){e.$set(e.formValidate,"affirmPassword",t)},expression:"formValidate.affirmPassword"}})],1):e._e(),e._v(" "),-1===e.formValidate.id?a("FormItem",{attrs:{label:"发货仓",prop:"supplierId"}},[a("Select",{staticStyle:{width:"200px"},model:{value:e.formValidate.supplierId,callback:function(t){e.$set(e.formValidate,"supplierId",t)},expression:"formValidate.supplierId"}},e._l(e.supplierList,function(t){return a("Option",{key:t.id,attrs:{value:String(t.id)}},[e._v(e._s(t.supplierName)+"\n              ")])}))],1):e._e(),e._v(" "),"SUPPLIER"!==e.userInfoType?a("FormItem",{attrs:{label:"角色绑定",prop:"roleIds"}},[a("Select",{attrs:{disabled:"SUPPLIER"===e.userInfoType,multiple:""},model:{value:e.formValidate.roleIds,callback:function(t){e.$set(e.formValidate,"roleIds",t)},expression:"formValidate.roleIds"}},e._l(e.cityList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.roleName))])}))],1):e._e(),e._v(" "),a("FormItem",{attrs:{label:"用户姓名",prop:"name"}},[a("Input",{attrs:{maxlength:5,placeholder:"请输入"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1)],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",size:"large",long:"",loading:e.modal_loading},on:{click:function(t){e.handleSubmit("formValidate")}}},[e._v("\n          "+e._s(-1===e.formValidate.id?"添加":"修改")+"\n        ")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(r,s,!1,function(e){a("CMEB")},"data-v-2583dab4",null);t.default=o.exports}});