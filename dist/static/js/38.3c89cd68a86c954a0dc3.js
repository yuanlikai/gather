webpackJsonp([38],{"/IA2":function(e,t){},ila4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:function(){var e=this;return{like:"",id:"",handleId:"",total:0,start:0,cityList:[],loading:!0,statuss:!1,roleId:"全部",status:"全部",value13:"",value14:"",userInfoType:"",addAccount:!1,modal_loading:!1,roleName:"全部",roleList:[{id:"全部",roleName:"全部"}],formValidate:{roleIds:[],username:"",password:"",affirmPassword:"",name:"",supplierId:"",allField:!0},supplierList:"",ruleValidate:{username:[{validator:function(t,a,s){var r=e;a.length<1?s(new Error("请填写用户名")):r.Axios.post("/Manage/UserInfo/checkUserName",r.Qs.stringify({id:""!==r.id?r.id:"",username:r.formValidate.username})).then(function(e){0===e.data.code?s():s(new Error(e.data.message))})},required:!0,trigger:"blur"}],password:[{required:!0,message:"请输入",trigger:"blur"}],affirmPassword:[{validator:function(t,a,s){a.length<1?s(new Error("请输入确认密码")):e.formValidate.password!==a?s(new Error("两次密码输入不一致")):s()},required:!0,trigger:"blur"}],roleIds:[{validator:function(e,t,a){t.length<1?a(new Error("请选择角色")):a()},required:!0,trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"blur"}],supplierId:[{required:!0,message:"请输入",trigger:"change"}]},data:[]}},methods:{resetPass:function(e){var t=this;t.Axios.post("/Manage/UserInfo/resetPassword",t.Qs.stringify({username:e})).then(function(e){0===e.data.code?t.$Message.success("成功"):t.$Message.warning(e.data.message)})},getSupplier:function(){var e=this;e.Axios.get("/GetSupList.ashx").then(function(t){0===t.data.code?e.supplierList=t.data.data:e.$Message.error(t.data.message)})},delHandle:function(e,t){var a=this;a.Axios.post("/Manage/UserInfo/deleteUsers",a.Qs.stringify({usernames:[e],ids:[t]},{indices:!1})).then(function(e){0===e.data.code?(a.getUser(),a.$Message.success("删除成功")):a.$Message.error(e.data.message)})},amend:function(e,t,a,s,r,i,o){this.id=e,this.addAccount=!0,this.userInfoType=t,this.formValidate.username=a,this.formValidate.name=s,this.formValidate.roleIds=r,this.formValidate.allField=o,this.statuss="0"===i},getRole:function(){var e=this;e.Axios.get("/Manage/Role/list",{params:{excludeSuper:!0,supplierExclusive:!0}}).then(function(t){e.roleList=e.roleList.concat(t.data.data)})},cityRole:function(){var e=this;e.Axios.get("/Manage/Role/supplierRoleList",{params:{excludeSuper:!0,supplierExclusive:!1}}).then(function(t){e.cityList=t.data.data})},paging:function(e){this.start=e-1,this.getUser()},addUser:function(){this.id="",this.userInfoType="",this.handleReset("formValidate"),this.statuss=!1,this.addAccount=!0},Handle:function(e){this.handleId===e?this.handleId="":this.handleId=e},getUser:function(){var e=this;e.loading=!0,e.Axios.post("/Manage/UserInfo/supplierUsers",e.Qs.stringify({start:e.start,size:5,usernameLike:e.value13,supplierNameLike:e.value14,status:"全部"===e.status?"":e.status,roleId:"全部"===e.roleId?"":e.roleId,userInfoType:""})).then(function(t){0===t.data.code?e.data=t.data.data.content:e.$Message.error(t.data.message),e.loading=!1,e.total=Number(t.data.data.totalElements)})},handleSubmit:function(e){var t=this;t.$refs[e].validate(function(e){e?(t.modal_loading=!0,""===t.id?t.Axios.post("/Manage/UserInfo/addSupplierUser",t.Qs.stringify({username:t.formValidate.username,password:t.formValidate.affirmPassword,name:t.formValidate.name,roleIdSet:t.formValidate.roleIds,supplierId:t.formValidate.supplierId,allField:t.formValidate.allField,sex:"MALE"},{indices:!1})).then(function(e){0===e.data.code?(t.addAccount=!1,t.getUser(),t.$Message.success("success")):t.$Message.error(e.data.message),t.modal_loading=!1}):t.Axios.post("/Manage/UserInfo/updateSupplierUser",t.Qs.stringify({id:t.id,username:t.formValidate.username,name:t.formValidate.name,roleIdSet:t.formValidate.roleIds,supplierId:t.formValidate.supplierId,allField:t.formValidate.allField,sex:"MALE"},{indices:!1})).then(function(e){0===e.data.code?(t.addAccount=!1,t.getUser(),t.$Message.success("success")):t.$Message.error(e.data.message),t.modal_loading=!1})):t.$Message.error("有必填项未填写!")})},handleReset:function(e){this.$refs[e].resetFields()},abc:function(e){console.log(e.target.parentElement)}},mounted:function(){this.getUser(),this.cityRole(),this.getRole(),this.getSupplier()}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("Card",{staticStyle:{border:"none",margin:"16px 0"}},[a("div",{staticClass:"ivu-page-header-title",on:{click:e.abc}},[e._v("供应商用户")])]),e._v(" "),a("Card",{style:{margin:"0 20px 20px 20px",background:"#fff",height:"auto"}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n        基础列表\n      ")]),e._v(" "),a("p",{attrs:{slot:"extra"},slot:"extra"},[a("Icon",{attrs:{type:"ios-loop-strong"}}),e._v(" "),a("span",{staticClass:"users",staticStyle:{margin:"3px 4px 0 0"}},[e._v("角色:")]),e._v(" "),a("Select",{staticClass:"users",staticStyle:{width:"100px","margin-right":"16px"},on:{"on-change":function(t){e.start=0,e.getUser()}},model:{value:e.roleId,callback:function(t){e.roleId=t},expression:"roleId"}},e._l(e.roleList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.roleName))])})),e._v(" "),a("RadioGroup",{staticClass:"users",attrs:{type:"button"},on:{"on-change":function(t){e.start=0,e.getUser()}},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("Radio",{attrs:{label:"全部"}},[e._v("全部")]),e._v(" "),a("Radio",{attrs:{label:"1"}},[e._v("正常")]),e._v(" "),a("Radio",{attrs:{label:"0"}},[e._v("禁用")])],1),e._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"用户名搜索"},on:{"on-enter":function(t){e.start=0,e.getUser()}},model:{value:e.value13,callback:function(t){e.value13=t},expression:"value13"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:function(t){e.start=0,e.getUser()}},slot:"suffix"})],1),e._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"供应商搜索"},on:{"on-enter":function(t){e.start=0,e.getUser()}},model:{value:e.value14,callback:function(t){e.value14=t},expression:"value14"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:function(t){e.start=0,e.getUser()}},slot:"suffix"})],1)],1),e._v(" "),a("Button",{staticStyle:{width:"100%","margin-bottom":"16px"},attrs:{type:"dashed"},on:{click:function(t){e.addUser()}}},[e._v("添加")]),e._v(" "),e._l(e.data,function(t,s){return a("Row",{key:s,staticStyle:{padding:"12px 0","border-bottom":"1px solid #e8eaec"}},[a("Col",{staticStyle:{"margin-bottom":"16px"},attrs:{span:"24"}},[a("Avatar",{staticStyle:{"margin-right":"8px"},attrs:{src:"https://i.loli.net/2017/08/21/599a521472424.jpg"}}),e._v(" "),a("span",{staticStyle:{"font-weight":"700"}},[e._v(e._s(t.username))])],1),e._v(" "),a("Col",{attrs:{span:"24"}},[e._v("状态：\n          "),a("Badge",{attrs:{status:"1"===t.status?"success":"error"}}),e._v("\n          "+e._s("1"===t.status?"正常":"锁定")+"\n        ")],1),e._v(" "),a("Col",{attrs:{span:"24"}},[e._v("姓名："+e._s(t.name))]),e._v(" "),t.supplierName?a("Col",{attrs:{span:"24"}},[e._v("供应商："+e._s(t.supplierName))]):e._e(),e._v(" "),a("Col",{staticStyle:{"margin-top":"8px"},attrs:{span:"24"}},[a("Tag",{attrs:{color:"geekblue"}},[e._v(e._s(t.roleNames))]),e._v(" "),a("Button",{staticStyle:{"margin-left":"16px"},attrs:{size:"small",icon:"md-list"},on:{click:function(a){e.Handle(t.id)}}},[e._v("展开操作")])],1),e._v(" "),e.handleId===t.id?a("Col",{staticStyle:{"margin-top":"16px"},attrs:{span:"24"}},[a("Button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.amend(t.id,t.userInfoType,t.username,t.name,t.roleIds,t.status,t.allField)}}},[e._v("修改用户\n          ")]),e._v(" "),a("Divider",{attrs:{type:"vertical"}}),e._v(" "),a("Poptip",{attrs:{confirm:"",title:"确定删除该用户？"},on:{"on-ok":function(a){e.delHandle(t.username,t.id)}}},[a("Button",{attrs:{size:"small",type:"primary"}},[e._v("删除用户")])],1),e._v(" "),a("Divider",{attrs:{type:"vertical"}}),e._v(" "),a("Poptip",{attrs:{confirm:"",title:"确定重置该用户密码？"},on:{"on-ok":function(a){e.resetPass(t.username)}}},[a("Button",{attrs:{size:"small",type:"primary"}},[e._v("重置密码")])],1)],1):e._e()],1)}),e._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center","margin-top":"15px"}},[a("Page",{attrs:{total:e.total,"page-size":5,"show-elevator":"","show-total":""},on:{"on-change":e.paging}})],1)],2),e._v(" "),a("Modal",{attrs:{width:"300"},model:{value:e.addAccount,callback:function(t){e.addAccount=t},expression:"addAccount"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),e._v(" "),a("span",[e._v(e._s(""===e.id?"添加":"修改")+"用户")])],1),e._v(" "),a("div",[a("Form",{ref:"formValidate",attrs:{model:e.formValidate,rules:e.ruleValidate,"label-width":70}},["SUPPLIER"!==e.userInfoType?a("FormItem",{attrs:{label:"用户账号",prop:"username"}},[a("Input",{attrs:{disabled:""!==e.id,maxlength:36,placeholder:"请输入账号"},model:{value:e.formValidate.username,callback:function(t){e.$set(e.formValidate,"username",t)},expression:"formValidate.username"}})],1):e._e(),e._v(" "),""===e.id?a("FormItem",{attrs:{label:"用户密码",prop:"password"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请输入密码"},model:{value:e.formValidate.password,callback:function(t){e.$set(e.formValidate,"password",t)},expression:"formValidate.password"}})],1):e._e(),e._v(" "),""===e.id?a("FormItem",{attrs:{label:"确认密码",prop:"affirmPassword"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请确认密码"},model:{value:e.formValidate.affirmPassword,callback:function(t){e.$set(e.formValidate,"affirmPassword",t)},expression:"formValidate.affirmPassword"}})],1):e._e(),e._v(" "),""===e.id?a("FormItem",{attrs:{label:"供应商",prop:"supplierId"}},[a("Select",{staticStyle:{width:"200px"},model:{value:e.formValidate.supplierId,callback:function(t){e.$set(e.formValidate,"supplierId",t)},expression:"formValidate.supplierId"}},e._l(e.supplierList,function(t){return a("Option",{key:t.id,attrs:{value:String(t.id)}},[e._v(e._s(t.supplierName)+"\n              ")])}))],1):e._e(),e._v(" "),"SUPPLIER"!==e.userInfoType?a("FormItem",{attrs:{label:"角色绑定",prop:"roleIds"}},[a("Select",{attrs:{disabled:"SUPPLIER"===e.userInfoType,multiple:""},model:{value:e.formValidate.roleIds,callback:function(t){e.$set(e.formValidate,"roleIds",t)},expression:"formValidate.roleIds"}},e._l(e.cityList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.roleName))])}))],1):e._e(),e._v(" "),a("FormItem",{attrs:{label:"用户姓名",prop:"name"}},[a("Input",{attrs:{maxlength:5,placeholder:"请输入"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),e._v(" "),a("FormItem",{attrs:{label:"所有字段显示",prop:"allField"}},[a("i-switch",{model:{value:e.formValidate.allField,callback:function(t){e.$set(e.formValidate,"allField",t)},expression:"formValidate.allField"}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("开")]),e._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("关")])])],1)],1)],1),e._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",size:"large",long:"",loading:e.modal_loading},on:{click:function(t){e.handleSubmit("formValidate")}}},[e._v("\n          "+e._s(""===e.id?"添加":"修改")+"\n        ")])],1)])],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(e){a("/IA2")},"data-v-173443cb",null);t.default=i.exports}});