webpackJsonp([22],{"AC+8":function(t,e){},c6qM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={props:["supplier"],data:function(){var t=this;return{checId:[],show:!0,seed:!1,loading:!0,formValidate:{skuInfoNameLike:"",skuInfoNoLike:"",classify:[],brandId:""},titles:["全部商品","已选中商品"],treeData:[],brandList:[],current:this.$route.query.ids?1:0,sjLoding:!1,data:[],targetKeys:[],fillInList:[],start:1,columns:[{title:"商品名",key:"skuInfoName"},{title:"SKU编号",maxWidth:140,key:"skuInfoNo"},{title:"市场价 (必填)",maxWidth:170,key:"marketPrice",render:function(e,a){return e("input",{style:{width:"100px",border:"1px solid #dcdee2",padding:"0 4px"},attrs:{value:a.row.marketPrice,type:"text",maxlength:"7"},on:{input:function(t){t.target.value.length<1&&(t.target.value=1),t.target.value=t.target.value.match(/\d+(\.\d{0,2})?/)?t.target.value.match(/\d+(\.\d{0,2})?/)[0]:""},blur:function(e){t.fillInList[a.row.platformName][a.index].marketPrice=e.target.value}}})}},{title:"售价 (必填)",maxWidth:170,key:"price",render:function(e,a){return e("input",{style:{width:"100px",border:"1px solid #dcdee2",padding:"0 4px"},attrs:{value:a.row.price,type:"text",maxlength:"7"},on:{input:function(t){t.target.value.length<1&&(t.target.value=1),t.target.value=t.target.value.match(/\d+(\.\d{0,2})?/)?t.target.value.match(/\d+(\.\d{0,2})?/)[0]:""},blur:function(e){t.fillInList[a.row.platformName][a.index].price=e.target.value}}})}},{title:"折扣（0.1~9.9）",maxWidth:170,key:"discount",render:function(e,a){return e("input",{style:{width:"100px",border:"1px solid #dcdee2",padding:"0 4px"},attrs:{value:a.row.discount,type:"text",maxlength:"7"},on:{input:function(t){t.target.value=t.target.value.match(/\d+(\.\d{0,1})?/)?t.target.value.match(/\d+(\.\d{0,1})?/)[0]:""},blur:function(e){t.fillInList[a.row.platformName][a.index].discount=e.target.value}}})}}]}},methods:{screen:function(t){this.rePage(),this.formValidate.classify=t,this.dataList()},putaway:function(){var t=this;t.sjLoding=!0;var e=[];for(var a in t.fillInList)-1!==t.checId.indexOf(t.fillInList[a][0].platformId)&&(e=e.concat(t.fillInList[a]));e.length<1?(t.$Message.warning("请选择上架平台！"),t.sjLoding=!1):t.Axios.post("/Manage/SkuInfo/onSale",e).then(function(e){0===e.data.code?(t.current=2,t.targetKeys=[],t.$Message.success("上架成功！")):t.$Message.warning(e.data.message),t.sjLoding=!1})},fillIn:function(){var t=this;t.targetKeys.length>20?t.$Message.warning("最多选择20个商品"):(t.current=1,t.Axios.post("/Manage/SkuInfo/readyOnsaleList",t.Qs.stringify({ids:t.$route.query.ids?t.$route.query.ids:t.targetKeys},{indices:!1})).then(function(e){for(var a in t.fillInList=e.data.data,t.fillInList)t.checId.push(t.fillInList[a][0].platformId);e.data.data||(t.show=!1,t.$Message.warning("该商品分类未绑定平台"))}))},renders:function(t){return t.label},handleChange:function(t,e,a){this.targetKeys=t},dataList:function(){var t=this;t.titles[0]="全部商品",t.Axios.get("/Manage/SkuInfo/readyOnsaleProducts",{params:{start:t.start-1,size:50,skuInfoNameLike:t.formValidate.skuInfoNameLike,skuInfoNoLike:t.formValidate.skuInfoNoLike,category1:t.formValidate.classify[0],category2:t.formValidate.classify[1],category3:t.formValidate.classify[2],brandId:t.formValidate.brandId,seed:t.seed}}).then(function(e){for(var a in e.data.data.content)t.data.push({key:e.data.data.content[a].id,label:e.data.data.content[a].abbrPlatformNames?e.data.data.content[a].skuInfoName+" - "+e.data.data.content[a].abbrPlatformNames:e.data.data.content[a].skuInfoName,disabled:!e.data.data.content[a].abbrPlatformNames,render:function(t,e){return console.log(e.row),t("p","123")}});t.titles[0]=t.titles[0]+"("+e.data.data.totalElements+")",t.loading=!1})},getTree:function(){var t=this;t.Axios.get("/Manage/Category/treeList").then(function(e){t.treeData=e.data.data})},getBrand:function(){var t=this;t.Axios.get("/Manage/Brand/selectBrand").then(function(e){t.brandList=e.data.data.content})},handleReset:function(t){this.$refs[t].resetFields(),this.formValidate.brandId="",this.seed=!1,this.dataList()},rePage:function(){this.start=1,this.data=[]}},watch:{$route:function(t,e){this.current=0,this.getTree(),this.getBrand(),this.dataList()}},mounted:function(){var t=this;document.getElementsByClassName("ivu-transfer-list-content")[0].onscroll=function(){document.getElementsByClassName("ivu-transfer-list-content")[0].scrollTop+365>document.getElementsByClassName("ivu-transfer-list-content")[0].scrollHeight&&(t.start=t.start+1,t.dataList())},this.$route.query.ids?this.fillIn():(this.getTree(),this.getBrand(),this.dataList())}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("Card",{staticStyle:{border:"none",margin:"16px 0"}},[a("div",{staticClass:"ivu-page-header-title"},[t._v("商品上架")])]),t._v(" "),a("Card",{directives:[{name:"show",rawName:"v-show",value:!t.$route.query.ids,expression:"!$route.query.ids"}],style:{margin:"16px 20px",background:"#fff",height:"auto"}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      筛选查询\n    ")]),t._v(" "),a("Form",{ref:"formValidate",attrs:{model:t.formValidate,"label-width":80}},[a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{xs:24,md:12,lg:8}},[a("FormItem",{attrs:{label:"商品名称：",prop:"skuInfoNameLike"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.formValidate.skuInfoNameLike,callback:function(e){t.$set(t.formValidate,"skuInfoNameLike",e)},expression:"formValidate.skuInfoNameLike"}})],1)],1),t._v(" "),a("Col",{attrs:{xs:24,md:12,lg:8}},[a("FormItem",{attrs:{label:"商品分类：",prop:"classify"}},[a("Cascader",{attrs:{data:t.treeData},on:{"on-change":t.screen},model:{value:t.formValidate.classify,callback:function(e){t.$set(t.formValidate,"classify",e)},expression:"formValidate.classify"}})],1)],1),t._v(" "),a("Col",{attrs:{xs:24,md:12,lg:8}},[a("FormItem",{attrs:{label:"品牌：",prop:"brandNameLike"}},[a("Select",{attrs:{clearable:""},on:{"on-change":function(e){t.rePage(),t.dataList()}},model:{value:t.formValidate.brandId,callback:function(e){t.$set(t.formValidate,"brandId",e)},expression:"formValidate.brandId"}},t._l(t.brandList,function(e,r){return a("Option",{key:r,attrs:{value:e.id}},[t._v(t._s(e.brandName))])}))],1)],1),t._v(" "),a("Col",{attrs:{xs:24,md:12,lg:8}},[a("FormItem",{attrs:{label:"编号：",prop:"skuInfoNoLike"}},[a("Input",{attrs:{placeholder:"请输入"},model:{value:t.formValidate.skuInfoNoLike,callback:function(e){t.$set(t.formValidate,"skuInfoNoLike",e)},expression:"formValidate.skuInfoNoLike"}})],1)],1),t._v(" "),a("Col",{attrs:{xs:24,md:24,lg:8}},[a("FormItem",[a("Button",{staticStyle:{"margin-right":"6px"},attrs:{type:"primary"},on:{click:function(e){t.rePage(),t.dataList()}}},[t._v("查询")]),t._v(" "),a("Button",{staticStyle:{"margin-right":"6px"},on:{click:function(e){t.rePage(),t.handleReset("formValidate")}}},[t._v("重置")])],1)],1)],1)],1)],1),t._v(" "),a("Card",{style:{margin:"16px 20px",background:"#fff",height:"auto"}},[a("p",{staticStyle:{"text-align":"left"},attrs:{slot:"title"},slot:"title"},[t._v("\n      选择商品\n    ")]),t._v(" "),a("a",{attrs:{slot:"extra",href:"#"},slot:"extra"}),t._v(" "),a("div",{staticStyle:{margin:"0 auto","max-width":"900px"}},[a("Steps",{directives:[{name:"show",rawName:"v-show",value:2!==t.current,expression:"current!==2"}],staticStyle:{margin:"16px 0 0 0"},attrs:{current:t.current}},[a("Step",{directives:[{name:"show",rawName:"v-show",value:!t.$route.query.ids,expression:"!$route.query.ids"}],staticStyle:{width:"70%"},attrs:{title:"选择商品"}}),t._v(" "),a("Step",{directives:[{name:"show",rawName:"v-show",value:!t.$route.query.ids,expression:"!$route.query.ids"}],staticStyle:{width:"30%"},attrs:{title:"填写销售信息"}})],1),t._v(" "),a("Row",{directives:[{name:"show",rawName:"v-show",value:0===t.current,expression:"current===0"}]},[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),t._v(" "),a("Col",{attrs:{span:"24"}},[a("Transfer",{attrs:{data:t.data,"target-keys":t.targetKeys,"list-style":{width:"380px",height:"400px",textAlign:"left",marginTop:"32px"},titles:t.titles,operations:["取消","选择"],"render-format":t.renders},on:{"on-change":t.handleChange}})],1),t._v(" "),a("Button",{staticStyle:{margin:"32px 0"},attrs:{disabled:!t.targetKeys.length>0,type:"primary"},on:{click:function(e){t.fillIn()}}},[t._v("\n          下一步，填写销售信息\n        ")])],1),t._v(" "),a("Row",{directives:[{name:"show",rawName:"v-show",value:1===t.current,expression:"current===1"}]},[a("Col",{attrs:{span:"24"}},[t._l(t.fillInList,function(e,r){return a("Row",{key:r},[a("Col",{staticStyle:{"margin-top":"32px","font-weight":"700"},attrs:{span:"24"}},[a("CheckboxGroup",{model:{value:t.checId,callback:function(e){t.checId=e},expression:"checId"}},[a("Checkbox",{attrs:{label:e[0].platformId,disabled:"SUPPLIER"===t.supplier.userType}},[a("span",[t._v(t._s(e[0].platformName))])])],1)],1),t._v(" "),a("Col",{attrs:{span:"24"}},[a("Table",{attrs:{columns:t.columns,data:e}})],1)],1)}),t._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:!t.$route.query.ids,expression:"!$route.query.ids"}],staticStyle:{margin:"32px 16px 32px 0"},attrs:{type:"primary",ghost:""},on:{click:function(e){t.current=0}}},[t._v("\n            上一步，选择商品平台\n          ")]),t._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticStyle:{margin:"32px 0"},attrs:{type:"primary",loading:t.sjLoding},on:{click:t.putaway}},[t._v("上架")])],2)],1),t._v(" "),a("Row",{directives:[{name:"show",rawName:"v-show",value:2===t.current,expression:"current===2"}]},[a("Col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[a("Icon",{staticStyle:{margin:"32px 0 24px 0"},attrs:{type:"ios-checkmark-circle",size:"90",color:"#19be6b"}}),t._v(" "),a("div",{staticClass:"ivu-result-title"},[t._v("上架成功")]),t._v(" "),a("Alert",{staticStyle:{width:"80%",margin:"0 auto 32px auto","font-size":"14px","text-align":"left",padding:"16px"}},[t._v("\n            商品上架成功，请到商品列表查看\n          ")]),t._v(" "),a("Button",{directives:[{name:"show",rawName:"v-show",value:!t.$route.query.ids,expression:"!$route.query.ids"}],attrs:{type:"primary"},on:{click:function(e){t.current=0}}},[t._v("继续上架")]),t._v(" \n        ")],1)],1)],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(r,n,!1,function(t){a("AC+8")},"data-v-6a51fc0c",null);e.default=s.exports}});