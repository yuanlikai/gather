webpackJsonp([21],{"2J2R":function(a,e){},iUBM:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={components:{upImg:t("JNXG").a},data:function(){var a=this;return{current:0,detail:{},formValidate:{id:"",brandName:"",abbrBrandName:"",brandStory:"",logoUrl:"",sortsNum:"50",display:"true",detailPics:[]},ruleValidate:{brandName:[{validator:function(e,t,r){var i=a;t?i.Axios.get("/Manage/Brand/validBrandName",{params:{id:i.$route.query.id?i.$route.query.id:"",brandName:t}}).then(function(a){0===a.data.code?r():r(new Error("品牌名称重复"))}):r(new Error("请输入品牌名称"))},min:6,required:!0,trigger:"blur"}],abbrBrandName:[{required:!0,message:"请填写品牌简称",trigger:"blur"}],logoUrl:[{validator:function(e,t,r){a.$refs.logoUrl.uploadList<1?r(new Error("请上传品牌logo")):r()},required:!0,trigger:"change"}]}}},methods:{handleSubmit:function(a){var e=this;e.formValidate.detailPics=[];for(var t=e.$refs.detailPics.uploadList,r=0;r<t.length;r++)e.formValidate.detailPics.push(t[r].filename);e.$refs[a].validate(function(a){a?e.Axios.post("/Manage/Brand/save",e.Qs.stringify({id:e.formValidate.id,brandName:e.formValidate.brandName,abbrBrandName:e.formValidate.abbrBrandName,brandStory:e.formValidate.brandStory,sortsNum:e.formValidate.sortsNum,logoUrl:e.$refs.logoUrl.uploadList[0].filename,brandImg:e.$refs.brandImg.uploadList.length>0?e.$refs.brandImg.uploadList[0].filename:"",display:e.formValidate.display,mainPic:e.$refs.mainPic.uploadList.length>0?e.$refs.mainPic.uploadList[0].filename:"",detailPics:e.formValidate.detailPics.join(",")})).then(function(a){0===a.data.code?(e.current=1,e.handleReset("formValidate"),e.$refs.logoUrl.uploadList=[],e.$refs.brandImg.uploadList=[],e.$refs.mainPic.uploadList=[],e.$refs.detailPics.uploadList=[],e.$Message.success(e.$route.query.id?"修改成功":"添加成功")):e.$Message.warning(a.data.message)}):e.$Message.error("有必填项未填写!")})},handleReset:function(a){this.$refs[a].resetFields()},getDetail:function(){var a=this;a.Axios.get("/Manage/Brand/detail",{params:{id:a.$route.query.id}}).then(function(e){if(a.formValidate={id:e.data.data.id,brandName:e.data.data.brandName,abbrBrandName:e.data.data.abbrBrandName,brandStory:e.data.data.brandStory,logoUrl:e.data.data.logoUrl,sortsNum:e.data.data.sortsNum,display:String(e.data.data.display)},a.$refs.logoUrl.defaultList.push({filename:e.data.data.logoUrl}),e.data.data.brandImg&&a.$refs.brandImg.defaultList.push({filename:e.data.data.brandImg}),e.data.data.mainPic&&a.$refs.mainPic.defaultList.push({filename:e.data.data.mainPic}),e.data.data.detailPics)for(var t=e.data.data.detailPics.split(","),r=0;r<t.length;r++)a.$refs.detailPics.defaultList.push({filename:t[r]})})}},mounted:function(){this.$route.query.id&&this.getDetail()}},i={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"content"},[t("Card",{staticStyle:{border:"none",margin:"16px 0"}},[t("div",{staticClass:"ivu-page-header-title"},[a._v(a._s(a.$route.query.id?"编辑":"添加")+"品牌")])]),a._v(" "),t("Card",{style:{margin:"16px 20px",background:"#fff",height:"auto"}},[t("Row",{directives:[{name:"show",rawName:"v-show",value:0===a.current,expression:"current===0"}]},[t("Col",{attrs:{md:{span:18,offset:3},lg:{span:10,offset:6}}},[t("Form",{ref:"formValidate",attrs:{model:a.formValidate,rules:a.ruleValidate,"label-width":80}},[t("FormItem",{attrs:{label:"品牌名称",prop:"brandName"}},[t("Input",{attrs:{maxlength:30,placeholder:"请输入"},model:{value:a.formValidate.brandName,callback:function(e){a.$set(a.formValidate,"brandName",e)},expression:"formValidate.brandName"}})],1),a._v(" "),t("FormItem",{attrs:{label:"品牌简称",prop:"abbrBrandName"}},[t("Input",{attrs:{maxlength:6,placeholder:"请输入"},model:{value:a.formValidate.abbrBrandName,callback:function(e){a.$set(a.formValidate,"abbrBrandName",e)},expression:"formValidate.abbrBrandName"}})],1),a._v(" "),t("FormItem",{attrs:{label:"品牌logo",prop:"logoUrl"}},[t("upImg",{ref:"logoUrl"})],1),a._v(" "),t("FormItem",{attrs:{label:"专区大图"}},[t("upImg",{ref:"brandImg"})],1),a._v(" "),t("FormItem",{attrs:{label:"题图"}},[t("upImg",{ref:"mainPic"})],1),a._v(" "),t("FormItem",{attrs:{label:"详情图"}},[t("upImg",{ref:"detailPics",attrs:{num:6}})],1),a._v(" "),t("FormItem",{attrs:{label:"品牌故事",prop:"brandStory"}},[t("Input",{attrs:{maxlength:100,type:"textarea",placeholder:"请输入"},model:{value:a.formValidate.brandStory,callback:function(e){a.$set(a.formValidate,"brandStory",e)},expression:"formValidate.brandStory"}})],1),a._v(" "),t("FormItem",{attrs:{label:"排序",prop:"sortsNum"}},[t("Input",{attrs:{maxlength:3,placeholder:"请输入"},on:{"on-keyup":function(e){a.formValidate.sortsNum=a.formValidate.sortsNum.replace(/[^\d]/g,"")}},model:{value:a.formValidate.sortsNum,callback:function(e){a.$set(a.formValidate,"sortsNum",e)},expression:"formValidate.sortsNum"}})],1),a._v(" "),t("FormItem",{attrs:{label:"是否显示",prop:"display"}},[t("RadioGroup",{model:{value:a.formValidate.display,callback:function(e){a.$set(a.formValidate,"display",e)},expression:"formValidate.display"}},[t("Radio",{attrs:{label:"true"}},[a._v("是")]),a._v(" "),t("Radio",{attrs:{label:"false"}},[a._v("否")])],1)],1),a._v(" "),t("FormItem",{attrs:{prop:"description"}},[t("Button",{attrs:{type:"primary"},on:{click:function(e){a.handleSubmit("formValidate")}}},[a._v("提交")])],1)],1)],1)],1),a._v(" "),t("Row",{directives:[{name:"show",rawName:"v-show",value:1===a.current,expression:"current===1"}]},[t("Col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[t("Icon",{staticStyle:{margin:"32px 0 24px 0"},attrs:{type:"ios-checkmark-circle",size:"90",color:"#19be6b"}}),a._v(" "),t("div",{staticClass:"ivu-result-title"},[a._v(a._s(a.$route.query.id?"修改":"添加")+"成功")]),a._v(" "),t("Alert",{staticStyle:{width:"50%",margin:"0 auto 32px auto","font-size":"14px","text-align":"left",padding:"16px"}},[a._v("\n          品牌"+a._s(a.$route.query.id?"修改":"添加")+"成功，请到品牌列表查看\n        ")]),a._v(" "),t("Button",{directives:[{name:"show",rawName:"v-show",value:!a.$route.query.id,expression:"!$route.query.id"}],attrs:{type:"primary"},on:{click:function(e){a.current=0}}},[a._v("继续添加")]),a._v(" \n      ")],1)],1)],1)],1)},staticRenderFns:[]};var o=t("VU/8")(r,i,!1,function(a){t("2J2R")},"data-v-59675c14",null);e.default=o.exports}});