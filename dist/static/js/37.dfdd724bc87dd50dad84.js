webpackJsonp([37],{dF51:function(t,e){},ila4:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){var t=this;return{like:"",id:"",handleId:"",total:0,start:0,cityList:[],loading:!0,statuss:!1,roleId:-1,status:-1,value13:"",value14:"",userInfoType:"",addAccount:!1,modal_loading:!1,roleName:"全部",roleList:[{id:-1,roleName:"全部"}],formValidate:{id:-1,roleIds:[],username:"",password:"",affirmPassword:"",name:"",supplierId:"",allField:!0},supplierList:"",ruleValidate:{username:[{validator:function(e,a,s){var r=t;a.length<1?s(new Error("请填写用户名")):r.Axios.post("/CheckUserName.ashx",{id:Number(r.formValidate.id),username:r.formValidate.username}).then(function(t){0===t.data.error?s():s(new Error(t.data.errorMsg))})},required:!0,trigger:"blur"}],password:[{required:!0,message:"请输入",trigger:"blur"}],affirmPassword:[{validator:function(e,a,s){a.length<1?s(new Error("请输入确认密码")):t.formValidate.password!==a?s(new Error("两次密码输入不一致")):s()},required:!0,trigger:"blur"}],roleIds:[{validator:function(t,e,a){e.length<1?a(new Error("请选择角色")):a()},required:!0,trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"blur"}],supplierId:[{required:!0,message:"请输入",trigger:"change"}]},data:[]}},methods:{resetPass:function(t){var e=this;e.Axios.post("/Manage/UserInfo/resetPassword",e.Qs.stringify({username:t})).then(function(t){0===t.data.code?e.$Message.success("成功"):e.$Message.warning(t.data.message)})},getSupplier:function(){var t=this;t.Axios.get("/GetSupList.ashx").then(function(e){0===e.data.error?t.supplierList=e.data.data:t.$Message.error(e.data.errorMsg)})},delHandle:function(t,e){var a=this;a.Axios.post("/Manage/UserInfo/deleteUsers",a.Qs.stringify({usernames:[t],ids:[e]},{indices:!1})).then(function(t){0===t.data.code?(a.getUser(),a.$Message.success("删除成功")):a.$Message.error(t.data.message)})},amend:function(t,e,a,s,r,i,o){this.formValidate.id=t,this.addAccount=!0,this.userInfoType=e,this.formValidate.username=a,this.formValidate.name=s,this.formValidate.roleIds=r,this.formValidate.allField=o,this.statuss="0"===i,console.log(this.formValidate)},getRole:function(){var t=this;t.Axios.get("/GetSelectRole.ashx",{excludeSuper:!0,supplierExclusive:!0}).then(function(e){t.roleList=t.roleList.concat(e.data.data)})},cityRole:function(){var t=this;t.Axios.post("/GetSelectRole2.ashx",{excludeSuper:!0,supplierExclusive:!1}).then(function(e){t.cityList=e.data.data})},paging:function(t){this.start=t-1,this.getUser()},addUser:function(){this.id="",this.userInfoType="",this.handleReset("formValidate"),this.statuss=!1,this.addAccount=!0},Handle:function(t){this.handleId===t?this.handleId="":this.handleId=t},getUser:function(){var t=this;t.loading=!0,t.Axios.post("/GetSupAdminList.ashx",{page:t.start,pagesize:10,usernameLike:t.value13,supplierNameLike:t.value14,status:t.status,roleId:Number(t.roleId),userInfoType:""}).then(function(e){t.data=e.data.data,0===e.data.error||t.$Message.error(e.data.errorMsg),t.loading=!1,t.total=Number(e.data.total)})},handleSubmit:function(t){var e=this;e.$refs[t].validate(function(t){if(t)return e.modal_loading=!0,void e.Axios.post("/EditSupAdmin.ashx",{id:Number(e.formValidate.id),username:e.formValidate.username,password:e.formValidate.affirmPassword,name:e.formValidate.name,roleId:e.formValidate.roleIds.join(","),supplierId:Number(e.formValidate.supplierId),allField:e.formValidate.allField,sex:"MALE"}).then(function(t){0===t.data.error?(e.addAccount=!1,e.getUser(),e.$Message.success("success")):e.$Message.error(t.data.message),e.modal_loading=!1});e.$Message.error("有必填项未填写!")})},handleReset:function(t){this.$refs[t].resetFields()},abc:function(t){console.log(t.target.parentElement)}},mounted:function(){this.getUser(),this.cityRole(),this.getRole(),this.getSupplier()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("Card",{staticStyle:{border:"none",margin:"16px 0"}},[a("div",{staticClass:"ivu-page-header-title",on:{click:t.abc}},[t._v("供应商用户")])]),t._v(" "),a("Card",{style:{margin:"0 20px 20px 20px",background:"#fff",height:"auto"}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n        基础列表\n      ")]),t._v(" "),a("p",{attrs:{slot:"extra"},slot:"extra"},[a("Icon",{attrs:{type:"ios-loop-strong"}}),t._v(" "),a("span",{staticClass:"users",staticStyle:{margin:"3px 4px 0 0"}},[t._v("角色:")]),t._v(" "),a("Select",{staticClass:"users",staticStyle:{width:"100px","margin-right":"16px"},on:{"on-change":function(e){t.start=0,t.getUser()}},model:{value:t.roleId,callback:function(e){t.roleId=e},expression:"roleId"}},t._l(t.roleList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.roleName))])})),t._v(" "),a("RadioGroup",{staticClass:"users",attrs:{type:"button"},on:{"on-change":function(e){t.start=0,t.getUser()}},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("Radio",{attrs:{label:-1}},[t._v("全部")]),t._v(" "),a("Radio",{attrs:{label:0}},[t._v("正常")]),t._v(" "),a("Radio",{attrs:{label:1}},[t._v("禁用")])],1),t._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"用户名搜索"},on:{"on-enter":function(e){t.start=0,t.getUser()}},model:{value:t.value13,callback:function(e){t.value13=e},expression:"value13"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:function(e){t.start=0,t.getUser()}},slot:"suffix"})],1),t._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"供应商搜索"},on:{"on-enter":function(e){t.start=0,t.getUser()}},model:{value:t.value14,callback:function(e){t.value14=e},expression:"value14"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:function(e){t.start=0,t.getUser()}},slot:"suffix"})],1)],1),t._v(" "),a("Button",{staticStyle:{width:"100%","margin-bottom":"16px"},attrs:{type:"dashed"},on:{click:function(e){t.addUser()}}},[t._v("添加")]),t._v(" "),t._l(t.data,function(e,s){return a("Row",{key:s,staticStyle:{padding:"12px 0","border-bottom":"1px solid #e8eaec"}},[a("Col",{staticStyle:{"margin-bottom":"16px"},attrs:{span:"24"}},[a("Avatar",{staticStyle:{"margin-right":"8px"},attrs:{src:"https://i.loli.net/2017/08/21/599a521472424.jpg"}}),t._v(" "),a("span",{staticStyle:{"font-weight":"700"}},[t._v(t._s(e.username))])],1),t._v(" "),a("Col",{attrs:{span:"24"}},[t._v("状态：\n          "),a("Badge",{attrs:{status:"0"==e.status?"success":"error"}}),t._v("\n          "+t._s(0==e.status?"正常":"锁定")+"\n        ")],1),t._v(" "),a("Col",{attrs:{span:"24"}},[t._v("姓名："+t._s(e.name))]),t._v(" "),e.supplierName?a("Col",{attrs:{span:"24"}},[t._v("供应商："+t._s(e.supplierName))]):t._e(),t._v(" "),a("Col",{staticStyle:{"margin-top":"8px"},attrs:{span:"24"}},[a("Tag",{attrs:{color:"geekblue"}},[t._v(t._s(e.roleNames))]),t._v(" "),a("Button",{staticStyle:{"margin-left":"16px"},attrs:{size:"small",icon:"md-list"},on:{click:function(a){t.Handle(e.id)}}},[t._v("展开操作")])],1),t._v(" "),t.handleId===e.id?a("Col",{staticStyle:{"margin-top":"16px"},attrs:{span:"24"}},[a("Button",{attrs:{size:"small",type:"primary"},on:{click:function(a){t.amend(e.id,e.userInfoType,e.username,e.name,e.roleIds,e.status,e.allField)}}},[t._v("修改用户\n          ")]),t._v(" "),a("Divider",{attrs:{type:"vertical"}}),t._v(" "),a("Poptip",{attrs:{confirm:"",title:"确定删除该用户？"},on:{"on-ok":function(a){t.delHandle(e.username,e.id)}}},[a("Button",{attrs:{size:"small",type:"primary"}},[t._v("删除用户")])],1),t._v(" "),a("Divider",{attrs:{type:"vertical"}}),t._v(" "),a("Poptip",{attrs:{confirm:"",title:"确定重置该用户密码？"},on:{"on-ok":function(a){t.resetPass(e.username)}}},[a("Button",{attrs:{size:"small",type:"primary"}},[t._v("重置密码")])],1)],1):t._e()],1)}),t._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center","margin-top":"15px"}},[a("Page",{attrs:{total:t.total,"page-size":5,"show-elevator":"","show-total":""},on:{"on-change":t.paging}})],1)],2),t._v(" "),a("Modal",{attrs:{width:"300"},model:{value:t.addAccount,callback:function(e){t.addAccount=e},expression:"addAccount"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),a("span",[t._v(t._s(-1===t.formValidate.id?"添加":"修改")+"用户")])],1),t._v(" "),a("div",[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":70}},["SUPPLIER"!==t.userInfoType?a("FormItem",{attrs:{label:"用户账号",prop:"username"}},[a("Input",{attrs:{disabled:-1!==t.formValidate.id,maxlength:36,placeholder:"请输入账号"},model:{value:t.formValidate.username,callback:function(e){t.$set(t.formValidate,"username",e)},expression:"formValidate.username"}})],1):t._e(),t._v(" "),-1===t.formValidate.id?a("FormItem",{attrs:{label:"用户密码",prop:"password"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请输入密码"},model:{value:t.formValidate.password,callback:function(e){t.$set(t.formValidate,"password",e)},expression:"formValidate.password"}})],1):t._e(),t._v(" "),-1===t.formValidate.id?a("FormItem",{attrs:{label:"确认密码",prop:"affirmPassword"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请确认密码"},model:{value:t.formValidate.affirmPassword,callback:function(e){t.$set(t.formValidate,"affirmPassword",e)},expression:"formValidate.affirmPassword"}})],1):t._e(),t._v(" "),-1===t.formValidate.id?a("FormItem",{attrs:{label:"供应商",prop:"supplierId"}},[a("Select",{staticStyle:{width:"200px"},model:{value:t.formValidate.supplierId,callback:function(e){t.$set(t.formValidate,"supplierId",e)},expression:"formValidate.supplierId"}},t._l(t.supplierList,function(e){return a("Option",{key:e.id,attrs:{value:String(e.id)}},[t._v(t._s(e.supplierName)+"\n              ")])}))],1):t._e(),t._v(" "),"SUPPLIER"!==t.userInfoType?a("FormItem",{attrs:{label:"角色绑定",prop:"roleIds"}},[a("Select",{attrs:{disabled:"SUPPLIER"===t.userInfoType,multiple:""},model:{value:t.formValidate.roleIds,callback:function(e){t.$set(t.formValidate,"roleIds",e)},expression:"formValidate.roleIds"}},t._l(t.cityList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.roleName))])}))],1):t._e(),t._v(" "),a("FormItem",{attrs:{label:"用户姓名",prop:"name"}},[a("Input",{attrs:{maxlength:5,placeholder:"请输入"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",size:"large",long:"",loading:t.modal_loading},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("\n          "+t._s(-1===t.formValidate.id?"添加":"修改")+"\n        ")])],1)])],1)},staticRenderFns:[]};var i=a("VU/8")(s,r,!1,function(t){a("dF51")},"data-v-24732e17",null);e.default=i.exports}});