webpackJsonp([26],{BUyM:function(t,e){},f70j:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("lDlD"),r={data:function(){var t=this;return{model:!1,dataSite:[],ssq:[],formValidate:{consignee:"",phone:"",ssq:[],address:""},ruleValidate:{consignee:[{required:!0,message:"请填写",trigger:"blur"}],ssq:[{required:!0,type:"array",min:3,message:"请选择",trigger:"change"}],phone:[{validator:function(e,a,s){/^1[3456789]\d{9}$/.test(t.formValidate.phone)?s():s(new Error("请填写正确手机号"))},required:!0,trigger:"blur"}],address:[{required:!0,message:"请填写",trigger:"blur"}]}}},methods:{getSite:function(t){this.formValidate.consignee=t.consignee,this.formValidate.phone=t.phone,this.formValidate.address=t.address},dzjhs:function(t,e){this.ssq=e},handleSubmit:function(t){var e=this,a=this;this.$refs[t].validate(function(t){t?a.Axios.post("/Manage/Order/updateOrderAddress",a.Qs.stringify({id:a.$route.query.idstr,consignee:a.formValidate.consignee,phone:a.formValidate.phone,province:a.ssq[0].label,city:a.ssq[1].label,area:a.ssq[2].label,address:a.formValidate.address})).then(function(t){0===t.data.error?(a.model=!1,a.$emit("getOrder"),e.$Message.success("成功!")):e.$Message.warning(t.data.errorMsg)}):e.$Message.error("请填写必填项!")})},handleReset:function(t){this.$refs[t].resetFields()},getSsq:function(){var t=this;t.Axios.get("/Manage/Region/region").then(function(e){t.dataSite=e.data.RegionList})}},mounted:function(){this.getSsq()}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Modal",{attrs:{width:"360"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[a("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),a("span",[t._v("修改配送地址")])],1),t._v(" "),a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"收件人",prop:"consignee"}},[a("Input",{attrs:{placeholder:"请填写"},model:{value:t.formValidate.consignee,callback:function(e){t.$set(t.formValidate,"consignee",e)},expression:"formValidate.consignee"}})],1),t._v(" "),a("FormItem",{attrs:{label:"手机号",prop:"phone"}},[a("Input",{attrs:{placeholder:"请填写"},model:{value:t.formValidate.phone,callback:function(e){t.$set(t.formValidate,"phone",e)},expression:"formValidate.phone"}})],1),t._v(" "),a("FormItem",{attrs:{label:"选择地区",prop:"ssq"}},[a("Cascader",{attrs:{data:t.dataSite},on:{"on-change":t.dzjhs},model:{value:t.formValidate.ssq,callback:function(e){t.$set(t.formValidate,"ssq",e)},expression:"formValidate.ssq"}})],1),t._v(" "),a("FormItem",{attrs:{label:"详细地址",prop:"address"}},[a("Input",{attrs:{type:"textarea",placeholder:"请填写"},model:{value:t.formValidate.address,callback:function(e){t.$set(t.formValidate,"address",e)},expression:"formValidate.address"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("确认")])],1)],1)},staticRenderFns:[]},o=a("VU/8")(r,i,!1,null,null,null).exports,l={components:{express:s.a,alterSite:o},data:function(){return{model:!1,formValidate:{abnormalstr:""},ruleValidate:{abnormalstr:[{required:!0,message:"请填写异常备注",trigger:"blur"}]},loading:!0,columns1:[{title:"操作者",tooltip:!0,minWidth:88,align:"center"},{title:"操作时间",tooltip:!0,minWidth:88,align:"center"},{title:"操作状态",tooltip:!0,minWidth:88,align:"center"},{title:"操作后状态",tooltip:!0,minWidth:88,align:"center"},{title:"备注",tooltip:!0,minWidth:88,align:"center"}],columns:[{title:"商品名称",tooltip:!0,key:"ProductName",minWidth:88,align:"center"},{title:"货号",tooltip:!0,key:"StockNo",minWidth:88,align:"center"},{title:"数量",tooltip:!0,key:"Num",minWidth:88,align:"center"},{title:"售价单价",tooltip:!0,key:"Price",minWidth:88,align:"center"},{title:"采购单价",tooltip:!0,key:"CostPrice",minWidth:88,align:"center"},{title:"供货单价",tooltip:!0,key:"CostPrice",minWidth:88,align:"center"},{title:"售价小计",tooltip:!0,key:"SumPrice",minWidth:88,align:"center"}],data:[],OperBtn:[]}},methods:{afterSsa:function(){this.$refs.alterSite.model=!0,this.$refs.alterSite.getSite({consignee:this.data.Consignee,phone:this.data.Phone,address:this.data.Address})},handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.abnormal()})},abnormal:function(){var t=this;t.Axios.post("/Manage/Order/operTransAbnormal",t.Qs.stringify({orderid:t.$route.query.idstr,abnormalstr:t.formValidate.abnormalstr})).then(function(e){0===e.data.error?(t.model=!1,t.$Message.success("转为异常成功")):t.$Message.warning(e.data.errorMsg)})},amend:function(){this.$refs.express.model=!0,this.$refs.express.formDynamic.idstr=this.$route.query.idstr;for(var t=0;t<this.data.Express.split("，").length;t++)this.$refs.express.formDynamic.items[t]={Express:this.data.Express.split("，")[t],ExpressNo:this.data.ExpressNo.split("，")[t]}},getDetails:function(){var t=this;t.Axios.get("/Manage/Order/detail",{params:{idstr:t.$route.query.idstr,vid:t.$route.query.vid}}).then(function(e){0===e.data.error?(t.OperBtn=e.data.data,t.data=e.data):t.$Message.error(e.data.errorMsg),t.loading=!1})}},mounted:function(){"3"===this.$route.query.vid?(this.columns.splice(3,2),this.$set(this.columns[4],"title","供货价小计"),this.$set(this.columns[4],"key","SumCostPrice"),console.log(this.columns[4])):"2"===this.$route.query.vid?(this.columns.splice(5,1),this.columns.push({title:"采购价小计",tooltip:!0,key:"SumCostPrice",minWidth:88,align:"center"})):"1"===this.$route.query.vid&&this.columns.splice(4,2),this.getDetails()}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("Card",{staticStyle:{border:"none",margin:"16px 0"}},[a("div",{staticClass:"ivu-page-header-title"},[t._v("当前订单状态：\n      "),"true"==t.$route.query.abnormal?a("span",{staticStyle:{color:"red"}},[t._v("异常")]):a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.data.StateStr))])]),t._v(" "),a("ButtonGroup",{staticStyle:{float:"right"}},["true"!=t.$route.query.abnormal?a("Button",{attrs:{type:"dashed"},on:{click:function(e){t.model=!0}}},[t._v("转为异常订单")]):a("Button",{attrs:{type:"dashed"}},[t._v("取消异常订单")])],1)],1),t._v(" "),a("Content",{style:{position:"relative",margin:"0 20px 20px 20px",background:"#fff",padding:"16px",height:"auto"}},[t.loading?a("Spin",{attrs:{fix:""}}):t._e(),t._v(" "),a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("基本信息")])]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        OMS单号："+t._s(t.data.ErpOrderNumber)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        平台单号："+t._s(t.data.OrderNumber)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        平台："+t._s(t.data.PlatformName)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        用户名："+t._s(t.data.UserName)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        下单时间："+t._s(t.data.AddTime)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        发货时间："+t._s(t.data.GetTime)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        支付方式："+t._s(t.data.PayTypeStr)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        供应商："+t._s(t.data.Supplier)+"\n      ")])],1),t._v(" "),a("Divider"),t._v(" "),a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("收货人及物流信息")])]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        快递公司："+t._s(t.data.Express)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        收货人："+t._s(t.data.Consignee)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        手机号："+t._s(t.data.Phone)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{xs:24,md:12,lg:8}},[t._v("\n        物流单号："+t._s(t.data.ExpressNo)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{md:24,lg:16}},[t._v("\n        地址："+t._s(t.data.Address)+"\n      ")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"16px"},attrs:{type:"primary"},on:{click:t.amend}},[t._v(t._s(t.data.ExpressNo?"修改":"填写")+"物流信息\n      ")]),t._v(" "),a("Button",{staticStyle:{"margin-left":"16px"},on:{click:t.afterSsa}},[t._v("修改配送信息\n      ")])],1),t._v(" "),a("Divider"),t._v(" "),a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("商品信息")])]),t._v(" "),a("Col",{attrs:{span:"24"}},[a("Table",{attrs:{"show-header":!0,columns:t.columns,data:t.OperBtn}})],1)],1),t._v(" "),a("Row",{staticStyle:{"font-size":"14px"},attrs:{gutter:30}},[a("Col",{staticStyle:{"margin-top":"16px"},attrs:{xs:{span:9,offset:1},lg:{span:11,offset:1}}},[t._v("\n        运费："+t._s(t.data.Freight)+"\n      ")]),t._v(" "),a("Col",{staticStyle:{"margin-top":"16px","text-align":"right"},attrs:{xs:13,lg:{span:11,pull:0}}},["3"===t.$route.query.vid?a("div",[t._v("\n          合计："),a("span",{staticStyle:{color:"red","font-weight":"700"}},[t._v(t._s(t.data.CostTotal))]),t._v("\n          (不含运费)\n        ")]):"2"===t.$route.query.vid?a("div",[t._v("\n          售价合计："),a("span",{staticStyle:{color:"red","font-weight":"700"}},[t._v(t._s(t.data.Total))]),t._v("\n          (不含运费)\n          "),a("br"),t._v("\n          采购价合计："),a("span",{staticStyle:{color:"red","font-weight":"700"}},[t._v(t._s(t.data.CostTotal))]),t._v("\n          (不含运费)\n        ")]):t._e(),t._v(" "),"1"===t.$route.query.vid?a("div",[t._v("\n          合计："),a("span",{staticStyle:{color:"red","font-weight":"700"}},[t._v(t._s(t.data.Total))]),t._v("\n          (不含运费)\n        ")]):t._e()])],1),t._v(" "),a("Divider"),t._v(" "),a("Row",{attrs:{gutter:30}},[a("Col",{attrs:{span:"24"}},[a("p",{staticClass:"colClass",staticStyle:{"font-weight":"500"}},[t._v("备注信息")])]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{span:"24"}},[t._v("\n        用户留言："+t._s(t.data.Remarks)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{span:"24"}},[t._v("\n        客服备注："+t._s(t.data.RemarksHt)+"\n      ")]),t._v(" "),a("Col",{staticClass:"colClass",attrs:{span:"24"}},[a("Button",{attrs:{type:"primary"}},[t._v("备注")])],1)],1),t._v(" "),a("Divider")],1),t._v(" "),a("express",{ref:"express",on:{getOrder:t.getDetails}}),t._v(" "),a("Modal",{attrs:{width:"360"},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}},[a("p",{staticStyle:{"text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),a("span",[t._v("确定转为异常？")])],1),t._v(" "),a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":60}},[a("FormItem",{attrs:{label:"备注",prop:"abnormalstr"}},[a("Input",{attrs:{type:"textarea",placeholder:"请输入备注信息"},model:{value:t.formValidate.abnormalstr,callback:function(e){t.$set(t.formValidate,"abnormalstr",e)},expression:"formValidate.abnormalstr"}})],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("确定")])],1)],1),t._v(" "),a("alterSite",{ref:"alterSite",attrs:{site:{consignee:t.data.Consignee,phone:t.data.Phone,address:t.data.address}},on:{getOrder:t.getDetails}})],1)},staticRenderFns:[]};var d=a("VU/8")(l,n,!1,function(t){a("BUyM")},"data-v-58c356b2",null);e.default=d.exports}});