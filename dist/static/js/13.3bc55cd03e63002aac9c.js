webpackJsonp([13],{"Qlo+":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){var t=this;return{like:"",id:"",handleId:"",total:0,start:0,pre:"0",select3:"0",cityList:[],loading:!0,statuss:!1,roleId:"全部",status:"全部",value13:"",userInfoType:"",addAccount:!1,modal_loading:!1,roleName:"全部",roleList:[{id:"全部",roleName:"全部"}],formValidate:{roleIds:[],username:"",password:"",affirmPassword:"",name:"",supplierId:""},supplierList:"",ruleValidate:{username:[{validator:function(e,a,s){var r=t;a.length<1?s(new Error("请填写用户名")):r.Axios.post("/Manage/UserInfo/checkUserName",r.Qs.stringify({id:""!==r.id?r.id:"",username:r.formValidate.username})).then(function(t){0===t.data.code?s():s(new Error(t.data.message))})},required:!0,trigger:"change"}],password:[{required:!0,message:"请输入",trigger:"blur"}],affirmPassword:[{validator:function(e,a,s){a.length<1?s(new Error("请输入确认密码")):t.formValidate.password!==a?s(new Error("两次密码输入不一致")):s()},required:!0,trigger:"blur"}],roleIds:[{validator:function(t,e,a){e.length<1?a(new Error("请选择角色")):a()},required:!0,trigger:"change"}],name:[{required:!0,message:"请输入",trigger:"change"}],supplierId:[{required:!0,message:"请输入",trigger:"change"}]},data:[]}},methods:{getProduct:function(){this.like=this.value13,this.getUser()},delHandle:function(t,e){var a=this;a.Axios.post("/Manage/UserInfo/deleteUsers",a.Qs.stringify({usernames:[t],ids:[e]},{indices:!1})).then(function(t){0===t.data.code?(a.getUser(),a.$Message.success("删除成功")):a.$Message.error(t.data.message)})},amend:function(t,e,a,s,r,o){this.id=t,this.addAccount=!0,this.userInfoType=e,this.formValidate.username=a,this.formValidate.name=s,this.formValidate.roleIds=r,this.statuss="0"===o},cityRole:function(){var t=this;t.Axios.get("/Manage/Role/list",{params:{excludeSuper:!0,supplierExclusive:!1}}).then(function(e){t.cityList=e.data.data})},paging:function(t){this.start=t-1,this.getUser()},addUser:function(){this.id="",this.userInfoType="",this.handleReset("formValidate"),this.statuss=!1,this.addAccount=!0},Handle:function(t){this.handleId===t?this.handleId="":this.handleId=t},getUser:function(){var t=this;t.loading=!0,t.Axios.post("/Manage/UserInfo/pageList",t.Qs.stringify({start:t.start,size:5,usernameLike:"0"===t.pre?this.like:"",supplierNameLike:"1"===t.pre?this.like:"",status:"全部"===t.status?"":t.status,roleId:"全部"===t.roleId?"":t.roleId,userInfoType:""})).then(function(e){0===e.data.code?t.data=e.data.data.content:t.$Message.error(e.data.message),t.loading=!1,t.total=Number(e.data.data.totalElements)})},handleSubmit:function(t){var e=this;e.$refs[t].validate(function(t){t?(e.modal_loading=!0,""===e.id?e.Axios.post("/Manage/UserInfo/addUser",e.Qs.stringify({status:!1===e.statuss?"1":"0",username:e.formValidate.username,password:e.formValidate.affirmPassword,name:e.formValidate.name,roleIdSet:e.formValidate.roleIds,supplierId:e.formValidate.supplierId},{indices:!1})).then(function(t){0===t.data.code?(e.addAccount=!1,e.getUser(),e.$Message.success("success")):e.$Message.error(t.data.message),e.modal_loading=!1}):e.Axios.post("/Manage/UserInfo/updateUser",e.Qs.stringify({id:e.id,status:!1===e.statuss?"1":"0",username:e.formValidate.username,name:e.formValidate.name,roleIdSet:e.formValidate.roleIds,supplierId:e.formValidate.supplierId},{indices:!1})).then(function(t){0===t.data.code?(e.addAccount=!1,e.getUser(),e.$Message.success("success")):e.$Message.error(t.data.message),e.modal_loading=!1})):e.$Message.error("有必填项未填写!")})},handleReset:function(t){this.$refs[t].resetFields()}},mounted:function(){this.getUser(),this.cityRole()}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content"},[a("Card",{staticStyle:{border:"none",margin:"16px 0"}},[a("div",{staticClass:"ivu-page-header-title"},[t._v("用户管理")])]),t._v(" "),a("Card",{style:{margin:"0 20px 20px 20px",background:"#fff",height:"auto"}},[a("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n        基础列表\n      ")]),t._v(" "),a("p",{attrs:{slot:"extra"},slot:"extra"},[a("Icon",{attrs:{type:"ios-loop-strong"}}),t._v(" "),a("span",{staticClass:"users",staticStyle:{margin:"3px 4px 0 0"}},[t._v("角色:")]),t._v(" "),a("Select",{staticClass:"users",staticStyle:{width:"100px","margin-right":"16px"},on:{"on-change":function(e){t.getUser()}},model:{value:t.roleId,callback:function(e){t.roleId=e},expression:"roleId"}},t._l(t.cityList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.roleName))])})),t._v(" "),a("RadioGroup",{staticClass:"users",attrs:{type:"button"},on:{"on-change":function(e){t.getUser()}},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[a("Radio",{attrs:{label:"全部"}},[t._v("全部")]),t._v(" "),a("Radio",{attrs:{label:"1"}},[t._v("正常")]),t._v(" "),a("Radio",{attrs:{label:"0"}},[t._v("禁用")])],1),t._v(" "),a("Input",{staticStyle:{width:"150px","margin-left":"16px"},attrs:{placeholder:"用户名搜索"},on:{"on-enter":function(e){t.getProduct()}},model:{value:t.value13,callback:function(e){t.value13=e},expression:"value13"}},[a("Icon",{staticStyle:{cursor:"pointer"},attrs:{slot:"suffix",type:"ios-search"},on:{click:t.getProduct},slot:"suffix"})],1)],1),t._v(" "),a("Button",{staticStyle:{width:"100%","margin-bottom":"16px"},attrs:{type:"dashed"},on:{click:function(e){t.addUser()}}},[t._v("添加")]),t._v(" "),t._l(t.data,function(e,s){return a("Row",{key:s,staticStyle:{padding:"12px 0","border-bottom":"1px solid #e8eaec"}},[a("Col",{staticStyle:{"margin-bottom":"16px"},attrs:{span:"24"}},[a("Avatar",{staticStyle:{"margin-right":"8px"},attrs:{src:"https://i.loli.net/2017/08/21/599a521472424.jpg"}}),t._v(" "),a("span",{staticStyle:{"font-weight":"700"}},[t._v(t._s(e.username))])],1),t._v(" "),a("Col",{attrs:{span:"24"}},[t._v("状态：\n          "),a("Badge",{attrs:{status:"1"===e.status?"success":"error"}}),t._v("\n          "+t._s("1"===e.status?"正常":"锁定")+"\n        ")],1),t._v(" "),a("Col",{attrs:{span:"24"}},[t._v("姓名："+t._s(e.name))]),t._v(" "),e.supplierName?a("Col",{attrs:{span:"24"}},[t._v("供应商："+t._s(e.supplierName))]):t._e(),t._v(" "),a("Col",{staticStyle:{"margin-top":"8px"},attrs:{span:"24"}},[a("Tag",{attrs:{color:"geekblue"}},[t._v(t._s(e.roleNames))]),t._v(" "),a("Button",{staticStyle:{"margin-left":"16px"},attrs:{size:"small",icon:"md-list"},on:{click:function(a){t.Handle(e.id)}}},[t._v("展开操作")])],1),t._v(" "),t.handleId===e.id?a("Col",{staticStyle:{"margin-top":"16px"},attrs:{span:"24"}},[a("Button",{attrs:{size:"small",type:"primary"},on:{click:function(a){t.amend(e.id,e.userInfoType,e.username,e.name,e.roleIds,e.status)}}},[t._v("修改用户\n          ")]),t._v(" "),a("Divider",{attrs:{type:"vertical"}}),t._v(" "),a("Poptip",{attrs:{confirm:"",title:"确定删除该用户？"},on:{"on-ok":function(a){t.delHandle(e.username,e.id)}}},[a("Button",{attrs:{size:"small",type:"primary"}},[t._v("删除用户")])],1)],1):t._e()],1)}),t._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center","margin-top":"15px"}},[a("Page",{attrs:{total:t.total,"page-size":5,"show-elevator":"","show-total":""},on:{"on-change":t.paging}})],1)],2),t._v(" "),a("Modal",{attrs:{width:"300"},model:{value:t.addAccount,callback:function(e){t.addAccount=e},expression:"addAccount"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),a("span",[t._v(t._s(""===t.id?"添加":"修改")+"用户")])],1),t._v(" "),a("div",[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate,"label-width":70}},["SUPPLIER"!==t.userInfoType?a("FormItem",{attrs:{label:"用户账号",prop:"username"}},[a("Input",{attrs:{disabled:""!==t.id,maxlength:36,placeholder:"请输入账号"},model:{value:t.formValidate.username,callback:function(e){t.$set(t.formValidate,"username",e)},expression:"formValidate.username"}})],1):t._e(),t._v(" "),""===t.id?a("FormItem",{attrs:{label:"用户密码",prop:"password"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请输入密码"},model:{value:t.formValidate.password,callback:function(e){t.$set(t.formValidate,"password",e)},expression:"formValidate.password"}})],1):t._e(),t._v(" "),""===t.id?a("FormItem",{attrs:{label:"确认密码",prop:"affirmPassword"}},[a("Input",{attrs:{maxlength:25,type:"password",placeholder:"请确认密码"},model:{value:t.formValidate.affirmPassword,callback:function(e){t.$set(t.formValidate,"affirmPassword",e)},expression:"formValidate.affirmPassword"}})],1):t._e(),t._v(" "),"SUPPLIER"!==t.userInfoType?a("FormItem",{attrs:{label:"角色绑定",prop:"roleIds"}},[a("Select",{attrs:{disabled:"SUPPLIER"===t.userInfoType,multiple:""},model:{value:t.formValidate.roleIds,callback:function(e){t.$set(t.formValidate,"roleIds",e)},expression:"formValidate.roleIds"}},t._l(t.cityList,function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.roleName))])}))],1):t._e(),t._v(" "),a("FormItem",{attrs:{label:"用户姓名",prop:"name"}},[a("Input",{attrs:{maxlength:5,placeholder:"请确认姓名"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,"name",e)},expression:"formValidate.name"}})],1),t._v(" "),a("FormItem",{attrs:{label:"是否锁定",prop:"statuss"}},[a("i-switch",{model:{value:t.statuss,callback:function(e){t.statuss=e},expression:"statuss"}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("是")]),t._v(" "),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("否")])])],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"success",size:"large",long:"",loading:t.modal_loading},on:{click:function(e){t.handleSubmit("formValidate")}}},[t._v("\n          "+t._s(""===t.id?"添加":"修改")+"\n        ")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(s,r,!1,function(t){a("YIym")},"data-v-7a7d8c50",null);e.default=o.exports},YIym:function(t,e){}});
//# sourceMappingURL=13.3bc55cd03e63002aac9c.js.map