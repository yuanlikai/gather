webpackJsonp([17],{"2gTj":function(a,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={components:{upImg:e("JNXG").a},data:function(){var a=this;return{current:0,detail:{},formValidate:{id:"",platformName:"",abbrPlatformName:"",logoUrl:"",platformNo:"",domian:"",description:"",status:!0},ruleValidate:{platformName:[{validator:function(t,e,r){var o=a;e?o.Axios.get("/Manage/Platform/valid/platformName",{params:{id:o.$route.query.id?o.$route.query.id:"",value:e}}).then(function(a){0===a.data.code?r():r(new Error("平台名称重复"))}):r(new Error("请输入平台名称"))},required:!0,trigger:"blur"}],abbrPlatformName:[{validator:function(t,e,r){var o=a;e?o.Axios.get("/Manage/Platform/valid/abbrPlatformName",{params:{id:o.$route.query.id?o.$route.query.id:"",value:e}}).then(function(a){0===a.data.code?r():r(new Error("平台简称重复"))}):r(new Error("请输入平台简称"))},required:!0,trigger:"blur"}],platformNo:[{validator:function(t,e,r){var o=a;e?o.Axios.get("/Manage/Platform/valid/platformNo",{params:{id:o.$route.query.id?o.$route.query.id:"",value:e}}).then(function(a){0===a.data.code?r():r(new Error("平台编号重复"))}):r(new Error("请输入平台编号"))},required:!0,mtrigger:"blur"}],domian:[{required:!0,message:"请输入域名",trigger:"blur"}]}}},methods:{handleSubmit:function(a){var t=this;t.$refs[a].validate(function(a){a?t.Axios.post("/Manage/Platform/save",t.Qs.stringify({id:t.formValidate.id,platformName:t.formValidate.platformName,abbrPlatformName:t.formValidate.abbrPlatformName,logoUrl:t.$refs.logo.uploadList.length>0?t.$refs.logo.uploadList[0].filename:"",domian:t.formValidate.domian,status:t.formValidate.status,platformNo:t.formValidate.platformNo,description:t.formValidate.description})).then(function(a){0===a.data.code?(t.current=1,t.handleReset("formValidate"),t.$refs.logo.uploadList=[],t.$Message.success(t.$route.query.id?"修改成功！":"添加成功！")):t.$Message.warning(a.data.message)}):t.$Message.error("有必填项未填写!")})},handleReset:function(a){this.$refs[a].resetFields()},getDetail:function(){var a=this;a.Axios.get("/Manage/Platform/detail",{params:{id:a.$route.query.id}}).then(function(t){a.formValidate={id:t.data.data.id,platformName:t.data.data.platformName,abbrPlatformName:t.data.data.abbrPlatformName,domian:t.data.data.domian,status:t.data.data.status,platformNo:t.data.data.platformNo,description:t.data.data.description},a.$refs.logo.defaultList.push({filename:t.data.data.logoUrl})})}},mounted:function(){this.$route.query.id&&this.getDetail()}},o={render:function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"content"},[e("Card",{staticStyle:{border:"none",margin:"16px 0"}},[e("div",{staticClass:"ivu-page-header-title"},[a._v(a._s(a.$route.query.id?"编辑":"添加")+"平台")])]),a._v(" "),e("Card",{style:{margin:"16px 20px",background:"#fff",height:"auto"}},[e("Row",{directives:[{name:"show",rawName:"v-show",value:0===a.current,expression:"current===0"}]},[e("Col",{attrs:{md:{span:18,offset:3},lg:{span:10,offset:6}}},[e("Form",{ref:"formValidate",attrs:{model:a.formValidate,rules:a.ruleValidate,"label-width":70}},[e("FormItem",{attrs:{label:"名称",prop:"platformName"}},[e("Input",{attrs:{maxlength:20,placeholder:"请输入"},model:{value:a.formValidate.platformName,callback:function(t){a.$set(a.formValidate,"platformName",t)},expression:"formValidate.platformName"}})],1),a._v(" "),e("FormItem",{attrs:{label:"简称",prop:"abbrPlatformName"}},[e("Input",{attrs:{maxlength:5,placeholder:"请输入"},model:{value:a.formValidate.abbrPlatformName,callback:function(t){a.$set(a.formValidate,"abbrPlatformName",t)},expression:"formValidate.abbrPlatformName"}})],1),a._v(" "),e("FormItem",{attrs:{label:"编号",prop:"platformNo"}},[e("Input",{attrs:{disabled:a.$route.query.id,maxlength:3,placeholder:"请输入"},on:{"on-keyup":function(t){a.formValidate.platformNo=a.formValidate.platformNo.replace(/[^a-zA-Z]/g,"").toUpperCase()}},model:{value:a.formValidate.platformNo,callback:function(t){a.$set(a.formValidate,"platformNo",t)},expression:"formValidate.platformNo"}})],1),a._v(" "),e("FormItem",{attrs:{label:"logo",prop:"logoUrl"}},[e("upImg",{ref:"logo"})],1),a._v(" "),e("FormItem",{attrs:{label:"域名",prop:"domian"}},[e("Input",{attrs:{maxlength:100,placeholder:"请输入"},model:{value:a.formValidate.domian,callback:function(t){a.$set(a.formValidate,"domian",t)},expression:"formValidate.domian"}})],1),a._v(" "),e("FormItem",{attrs:{label:"描述",prop:"description"}},[e("Input",{attrs:{maxlength:80,type:"textarea",placeholder:"请输入"},model:{value:a.formValidate.description,callback:function(t){a.$set(a.formValidate,"description",t)},expression:"formValidate.description"}})],1),a._v(" "),e("FormItem",{attrs:{label:"启用",prop:"status"}},[e("i-switch",{model:{value:a.formValidate.status,callback:function(t){a.$set(a.formValidate,"status",t)},expression:"formValidate.status"}},[e("Icon",{attrs:{slot:"open",type:"md-checkmark"},slot:"open"}),a._v(" "),e("Icon",{attrs:{slot:"close",type:"md-close"},slot:"close"})],1)],1),a._v(" "),e("FormItem",{attrs:{prop:"description"}},[e("Button",{attrs:{type:"primary"},on:{click:function(t){a.handleSubmit("formValidate")}}},[a._v("提交")])],1)],1)],1)],1),a._v(" "),e("Row",{directives:[{name:"show",rawName:"v-show",value:1===a.current,expression:"current===1"}]},[e("Col",{staticStyle:{"text-align":"center"},attrs:{span:"24"}},[e("Icon",{staticStyle:{margin:"32px 0 24px 0"},attrs:{type:"ios-checkmark-circle",size:"90",color:"#19be6b"}}),a._v(" "),e("div",{staticClass:"ivu-result-title"},[a._v(a._s(a.$route.query.id?"修改":"添加")+"成功")]),a._v(" "),e("Alert",{staticStyle:{width:"50%",margin:"0 auto 32px auto","font-size":"14px","text-align":"left",padding:"16px"}},[a._v("\n          平台"+a._s(a.$route.query.id?"修改":"添加")+"成功，请到平台列表查看\n        ")]),a._v(" "),e("Button",{directives:[{name:"show",rawName:"v-show",value:!a.$route.query.id,expression:"!$route.query.id"}],attrs:{type:"primary"},on:{click:function(t){a.current=0}}},[a._v("继续添加")]),a._v(" \n      ")],1)],1)],1)],1)},staticRenderFns:[]};var l=e("VU/8")(r,o,!1,function(a){e("UTJd")},"data-v-a16a3eee",null);t.default=l.exports},UTJd:function(a,t){}});